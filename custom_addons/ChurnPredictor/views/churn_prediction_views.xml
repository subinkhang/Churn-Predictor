<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- 
        File này chỉ còn giữ lại các định nghĩa chung như Search View và Pivot View gốc.
        Các Graph View và Action gây lỗi đã được comment out hoặc chuyển đi.
    -->

    <!-- Menu gốc (đảm bảo nó tồn tại) -->
    <menuitem 
        id="menu_churn_root"
        name="Churn Filter Dashboard"
        web_icon="ChurnPredictor,static/description/icon.png"
        sequence="10"/>

    <!-- Graph view cũ, đã được thay thế bằng view sạch hơn trong file churn_dashboard_views_1.xml -->
    <!-- <record id="view_churn_prediction_graph" model="ir.ui.view"> ... </record> -->

    <!-- Search View này rất quan trọng và vẫn được sử dụng -->
    <record id="view_churn_prediction_search" model="ir.ui.view">
        <field name="name">churn.prediction.search</field>
        <field name="model">churn.prediction</field>
        <field name="arch" type="xml">
            <search string="Search Churn Predictions">
                <field name="customer_name" string="Customer"/>
                <separator/>
                <group expand="1" string="Group By">
                    <filter name="group_by_period_month" string="Prediction Month" context="{'group_by': 'prediction_date:month'}"/>
                    <separator/>
                    <filter name="group_by_level" string="Probability Level" context="{'group_by': 'probability_level'}"/>
                    <filter name="group_by_result" string="Prediction Result" context="{'group_by': 'prediction_result'}"/>
                    <separator/>
                    <filter name="group_by_segment" string="Customer Segment" context="{'group_by': 'x_feat_segment'}"/>
                    <filter name="group_by_state" string="Customer State" context="{'group_by': 'customer_state_id'}"/>
                    <separator/>
                    <filter name="group_by_category" string="Last Product Category" context="{'group_by': 'x_feat_product_category_name_english_last'}"/>
                    <filter name="group_by_product_count" string="Number of Products Purchased" context="{'group_by': 'product_count'}"/>
                    <filter name="group_by_payment_type" string="Last Payment Type" context="{'group_by': 'x_feat_payment_type_last'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Pivot View gốc -->
    <record id="view_churn_prediction_pivot" model="ir.ui.view">
        <field name="name">churn.prediction.pivot</field>
        <field name="model">churn.prediction</field>
        <field name="arch" type="xml">
            <pivot string="Churn Probability Analysis">
                <field name="customer_id" type="row"/>
                <field name="prediction_result" type="col"/>
                <field name="probability" type="measure" operator="avg"/>
            </pivot>
        </field>
    </record>

</odoo>